<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>

        <style type="text/css">
            #callLabel {float:left;}
            #output-lbl {float:right;}
            /*            #call-to{float: left}
                        #call-audio-btn{float: right}*/
        </style>

        <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
        <script src="https://code.jquery.com/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
        <meta charset="utf-8">
        <title>Bootstrap Soft Phone UI</title>
        <link rel="stylesheet" href="css/style.css">
    </head>
    <body>
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <div class="panel panel-default soft-phone">

                        <form action="./">
                            <div class="form-group">

                                <div class="row">

                                    <div class="col-xs-4"><i class="glyphicon glyphicon-phone-alt"></i></div>
                                    <div class="col-xs-8"><span class="label label-danger " id="output-lbl">Offline</span></div>

                                </div>



                                <div class="row">
                                    <div class="col-md-8">
                                        <input type="tel" class="form-control input-md" id="call-to"  placeholder="Phone Number">
                                    </div>

                                    <div class="col">
                                        <a class="btn btn-success btn-md" id="call-audio-btn"><i class="glyphicon glyphicon-earphone"></i> Dial</a>
                                    </div>


                                </div>


                            </div>

                        </form>

                                                                        <div class="row">
                                                                            <div class="col-xs-4">
                                                                                <button class="btn btn-primary btn-lg btn-number">1<span>abc</span></button>
                                                                            </div>
                                                                            <div class="col-xs-4">
                                                                                <button class="btn btn-primary btn-lg btn-number">2<span>def</span></button>
                                                                            </div>
                                                                            <div class="col-xs-4">
                                                                                <button class="btn btn-primary btn-lg btn-number">3<span>ghi</span></button>
                                                                            </div>
                                                                        </div>
                                                                        <div class="row">
                                                                            <div class="col-xs-4">
                                                                                <button class="btn btn-primary btn-lg btn-number">4<span>jkl</span></button>
                                                                            </div>
                                                                            <div class="col-xs-4">
                                                                                <button class="btn btn-primary btn-lg btn-number">5<span>mno</span></button>
                                                                            </div>
                                                                            <div class="col-xs-4">
                                                                                <button class="btn btn-primary btn-lg btn-number">6<span>pqr</span></button>
                                                                            </div>
                                                                        </div>
                                                                        <div class="row">
                                                                            <div class="col-xs-4">
                                                                                <button class="btn btn-primary btn-lg btn-number">7<span>stu</span></button>
                                                                            </div>
                                                                            <div class="col-xs-4">
                                                                                <button class="btn btn-primary btn-lg btn-number">8<span>vwx</span></button>
                                                                            </div>
                                                                            <div class="col-xs-4">
                                                                                <button class="btn btn-primary btn-lg btn-number">9<span>yz</span></button>
                                                                            </div>
                                                                        </div>
                                                                        <div class="row">
                                                                            <div class="col-xs-4">
                                                                                <button class="btn btn-primary btn-lg btn-number">*</button>
                                                                            </div>
                                                                            <div class="col-xs-4">
                                                                                <button class="btn btn-primary btn-lg btn-number">0</button>
                                                                            </div>
                                                                            <div class="col-xs-4">
                                                                                <button class="btn btn-primary btn-lg btn-number">#</button>
                                                                            </div>
                                                                        </div>
                        <div class="row ">
                            <div class="col-xs-12">
                                <div class="btn-group btn-group-justified">


                                    <a class="btn btn-success btn-xs" id="answer-bt"><i class="glyphicon glyphicon-earphone"></i> Answer</a>
                                    <a class="btn btn-danger btn-xs " id="hangup-bt"><i class="glyphicon glyphicon-ban-circle"></i> Hang Up</a>
                                    <a class="btn btn-warning btn-xs" id="hold-bt"><i class="glyphicon glyphicon-pause"></i> Hold</a>
                                    <a class="btn btn-warning btn-xs" id="unhold-bt"><i class="glyphicon glyphicon-play"></i> Resume</a>
                                    <!--<a class="btn btn-danger btn-xs " onclick="Mute()" id="mute-btn"><i class="glyphicon glyphicon-volume-off"></i> Mute</a>-->

                                </div>
                            </div>
                        </div>

                        <div class="row pll">
                            <div class="form-group col">
                                <div class="input-group embed-responsive embed-responsive-16by9">
                                    <span class="local-text">Remote</span>
                                    <video controls autoplay id="remote-stream-video" class="embed-responsive-item"></video>
                                </div>
                                <div class="input-group embed-responsive embed-responsive-16by9 remote">
                                    <span class="remote-text">Local</span>
                                    <video  autoplay id="local-stream-video" class="embed-responsive-item"></video>
                                    <audio autoplay id="remote-stream-audio"></audio>
                                </div>
                            </div>
                        </div>
                    </div><!-- /.soft-phone -->
                </div><!-- /.col-xs-6 -->
            </div><!-- /.row -->
        </div><!-- /.container -->

        <script type="text/javascript">

            function stopRKey(evt) {
                var evt = (evt) ? evt : ((event) ? event : null);
                var node = (evt.target) ? evt.target : ((evt.srcElement) ? evt.srcElement : null);
                if ((evt.keyCode === 13)) {
                    return false;
                }
            }

            document.onkeypress = stopRKey;

        </script>
        <script>
            var input = document.getElementById("call-to");
            input.addEventListener("keyup", function (event) {
                if (event.keyCode === 13) {
                    event.preventDefault();
                    document.getElementById("call-audio-btn").click();
                }
            });
        </script>



        <script src="js/jquery.min.js"></script>
        <!--<script src="js/bootstrap.bundle.min.js"></script>-->
        <script src="js/adapter.js"></script>
        <script src="js/janus.js"></script>
        <script src="js/app.js"></script>
        <script src="js/webrtc-phone.js"></script>
        <script>


            $(document).ready(function () {

                webrtcPhone.initAndLogin({
                    server: "172.16.10.225", //janusIP,
                    server_port: "443",
                    server_protocol: "https",
                    sip_server: "172.16.10.225", //pbxIP,
                    sip_port: "5060",
                    name: "ibrahim Siddig",
                    exten: "225", //username,
                    password: "123456", //password,
                    audioId: 'remote-stream-audio',
                    localVideoId: 'local-stream-video',
                    remoteVideoId: 'remote-stream-video',
                    auto_answer: {enabled: false, timeout: 3000}
                });
            });
        </script>

        <script>
            function toggleMic() {
                console.log("toggling ");
                let  localStream = navigator.mediaDevices.getUserMedia();
                let mic_switch = true;
                if (localStream !== null && localStream.getAudioTracks().length > 0) {
                    mic_switch = !mic_switch;
                    localStream.getAudioTracks()[0].enabled = mic_switch;
                }
            }

            function Mute() {
                //var mute = false;
                console.log(" Muted Muted ");
//                document.getElementById("remote-stream-audio").muted = !mute;
//                var stream = getElementById("remote-stream-audio");
                //var  = navigator.mediaDevices.getUserMedia();
//                mediaStream.getAudioTracks()[1].enabled = false;
              
                navigator.mediaDevices.getUserMedia({audio: true, video: true})
                        .then(mediaStream => {
                            document.querySelector('video').srcObject = mediaStream;
                            // Stop the audio stream after 5 seconds
                            const tracks = mediaStream.getAudioTracks();
                            tracks[0].stop();
//                            setTimeout(() => {
//                                const tracks = mediaStream.getAudioTracks()
//                                tracks[0].stop()
//                            }, 5000)
                        });




            }
        </script>

    </body>
</html>
